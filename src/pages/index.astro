---
import Layout from "../layouts/Layout.astro";
import { Image } from "astro:assets";
import panini1996 from "../assets/images/panini-sticker-1996.png";
---

<Layout title="AC7">
    <main>
        <section class="min-h-screen grid place-items-center" id="ex1">
            <Image
                src={panini1996}
                alt="Aaron Conway as a panini sticker from 1996"
                class={"w-1/2 max-h-96 object-contain filter drop-shadow-xl"}
                id={"ex1-layer"}
            />
        </section>
    </main>
</Layout>

<style>
    img {
        aspect-ratio: 1;
        -webkit-mask: linear-gradient(135deg, #000c 40%, #000, #000c 60%) 100%
            100%/250% 250%;
        transition: -webkit-mask 2s;
    }
    img:hover {
        -webkit-mask-position: 0 0;
    }
</style>

<script>
    let constrain = 200;
    let mouseOverContainer = document.getElementById("ex1");
    let ex1Layer = document.getElementById("ex1-layer");

    function transforms(x, y, el) {
        let box = el.getBoundingClientRect();
        let calcX = -(y - box.y - box.height / 2) / constrain;
        let calcY = (x - box.x - box.width / 2) / constrain;

        return (
            "perspective(100px) " +
            "   rotateX(" +
            calcX +
            "deg) " +
            "   rotateY(" +
            calcY +
            "deg) "
        );
    }

    function transformElement(el, xyEl) {
        el.style.transform = transforms.apply(null, xyEl);
    }

    mouseOverContainer.onmousemove = function (e) {
        let xy = [e.clientX, e.clientY];
        let position = xy.concat([ex1Layer]);

        window.requestAnimationFrame(function () {
            transformElement(ex1Layer, position);
        });
    };
</script>
